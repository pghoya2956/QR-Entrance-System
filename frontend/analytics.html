<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌÜµÍ≥Ñ Î∂ÑÏÑù - QR ÏûÖÏû• Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-layout">
        <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/" class="sidebar-logo">
                    <div class="sidebar-logo-icon">QR</div>
                    <div class="sidebar-logo-text">ÏûÖÏû• Í¥ÄÎ¶¨</div>
                </a>
            </div>
            
            <nav class="sidebar-nav">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Î©îÏù∏ Î©îÎâ¥</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-menu-item">
                            <a href="index.html" class="sidebar-link">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                </svg>
                                <span>ÎåÄÏãúÎ≥¥Îìú</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="attendees.html" class="sidebar-link">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                </svg>
                                <span>Ï∞∏Í∞ÄÏûê Í¥ÄÎ¶¨</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="scanner.html" class="sidebar-link">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>
                                </svg>
                                <span>QR Ïä§Ï∫êÎÑà</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Ïù¥Î≤§Ìä∏ Í¥ÄÎ¶¨</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-menu-item">
                            <a href="events.html" class="sidebar-link">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                <span>Ïù¥Î≤§Ìä∏ Î™©Î°ù</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="analytics.html" class="sidebar-link active">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                                <span>ÌÜµÍ≥Ñ Î∂ÑÏÑù</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-section-title">ÏãúÏä§ÌÖú</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-menu-item">
                            <a href="settings.html" class="sidebar-link">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <span>ÏÑ§Ï†ï</span>
                            </a>
                        </li>
                        <li class="sidebar-menu-item">
                            <a href="backup.html" class="sidebar-link">
                                <svg class="sidebar-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path>
                                </svg>
                                <span>Î∞±ÏóÖ Í¥ÄÎ¶¨</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>
        
        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
        <main class="main-content">
            <!-- Ìó§Îçî -->
            <header class="header">
                <div class="header-content">
                    <div class="header-left">
                        <h1 class="header-title">ÌÜµÍ≥Ñ Î∂ÑÏÑù</h1>
                    </div>
                    
                    <div class="header-right">
                        <select class="event-select" id="eventSelect" onchange="handleEventChange()">
                            <option value="">Ïù¥Î≤§Ìä∏ ÏÑ†ÌÉù</option>
                        </select>
                        
                        <button class="header-btn">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                            </svg>
                            <span class="header-notification-badge"></span>
                        </button>
                        
                        <div class="header-user">
                            <div class="header-user-avatar">Í¥Ä</div>
                            <div class="header-user-info">
                                <div class="header-user-name">Í¥ÄÎ¶¨Ïûê</div>
                                <div class="header-user-role">Administrator</div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- ÌéòÏù¥ÏßÄ ÏΩòÌÖêÏ∏† -->
            <div class="page-content">
                <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
                <div class="page-header">
                    <h2 class="page-title">Ïù¥Î≤§Ìä∏ ÌÜµÍ≥Ñ Î∂ÑÏÑù</h2>
                    <p class="page-subtitle">Ïù¥Î≤§Ìä∏ Ï∞∏Í∞Ä ÌòÑÌô©Í≥º Ìä∏Î†åÎìúÎ•º ÌïúÎààÏóê ÌôïÏù∏Ìï©ÎãàÎã§</p>
                </div>
                
                <!-- ÌÜµÍ≥Ñ ÏöîÏïΩ Ïπ¥Îìú -->
                <div class="stats-container">
                    <div class="stat-card primary">
                        <div class="stat-header">
                            <div class="stat-content">
                                <div class="stat-label">Ï†ÑÏ≤¥ Ï∞∏Í∞ÄÏûê</div>
                                <div class="stat-value" id="totalParticipants">0</div>
                                <div class="stat-change positive">
                                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                    <span>Ï†ÑÏõî ÎåÄÎπÑ 15%</span>
                                </div>
                            </div>
                            <div class="stat-icon">üë•</div>
                        </div>
                    </div>
                    
                    <div class="stat-card success">
                        <div class="stat-header">
                            <div class="stat-content">
                                <div class="stat-label">ÌèâÍ∑† Ï∞∏ÏÑùÎ•†</div>
                                <div class="stat-value" id="avgAttendanceRate">0%</div>
                                <div class="stat-change positive">
                                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                    <span>Í∞úÏÑ† Ï§ë</span>
                                </div>
                            </div>
                            <div class="stat-icon">üìà</div>
                        </div>
                    </div>
                    
                    <div class="stat-card warning">
                        <div class="stat-header">
                            <div class="stat-content">
                                <div class="stat-label">Ïò§Îäò Ï≤¥ÌÅ¨Ïù∏</div>
                                <div class="stat-value" id="todayCheckins">0</div>
                                <div class="stat-change">
                                    <span>Ïã§ÏãúÍ∞Ñ</span>
                                </div>
                            </div>
                            <div class="stat-icon">üìÖ</div>
                        </div>
                    </div>
                    
                    <div class="stat-card info">
                        <div class="stat-header">
                            <div class="stat-content">
                                <div class="stat-label">Ïù¥Î≤à Ï£º Ï≤¥ÌÅ¨Ïù∏</div>
                                <div class="stat-value" id="weekCheckins">0</div>
                                <div class="stat-change">
                                    <span>Ï£ºÍ∞Ñ ÌÜµÍ≥Ñ</span>
                                </div>
                            </div>
                            <div class="stat-icon">üìä</div>
                        </div>
                    </div>
                </div>
                
                <!-- Ï∞®Ìä∏ ÏÑπÏÖò -->
                <div class="charts-grid">
                    <!-- Ï≤¥ÌÅ¨Ïù∏ Ï∂îÏù¥ Ï∞®Ìä∏ -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Ï≤¥ÌÅ¨Ïù∏ Ï∂îÏù¥</h3>
                            <div class="card-actions">
                                <select class="chart-period" id="checkinPeriod">
                                    <option value="week">Ï£ºÍ∞Ñ</option>
                                    <option value="month">ÏõîÍ∞Ñ</option>
                                    <option value="year">Ïó∞Í∞Ñ</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="checkinTrendChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Ï∞∏Í∞ÄÏûê Î∂ÑÌè¨ Ï∞®Ìä∏ -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Ï∞∏Í∞ÄÏûê Ïú†Ìòï Î∂ÑÌè¨</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="participantTypeChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- ÏãúÍ∞ÑÎåÄÎ≥Ñ Ï≤¥ÌÅ¨Ïù∏ Ï∞®Ìä∏ -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ÏãúÍ∞ÑÎåÄÎ≥Ñ Ï≤¥ÌÅ¨Ïù∏</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="hourlyCheckinChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- ÌöåÏÇ¨Î≥Ñ Ï∞∏Í∞ÄÏûê Ï∞®Ìä∏ -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ÌöåÏÇ¨Î≥Ñ Ï∞∏Í∞Ä ÌòÑÌô©</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="companyChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- ÏÉÅÏÑ∏ ÌÜµÍ≥Ñ ÌÖåÏù¥Î∏î -->
                <div class="card" style="margin-top: 24px;">
                    <div class="card-header">
                        <h3 class="card-title">ÏÉÅÏÑ∏ ÌÜµÍ≥Ñ</h3>
                        <div class="card-actions">
                            <button class="btn btn-outline" onclick="exportAnalytics()">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                </svg>
                                ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Ìï≠Î™©</th>
                                    <th>Í∞í</th>
                                    <th>Ï†ÑÏ£º ÎåÄÎπÑ</th>
                                    <th>Ï†ÑÏõî ÎåÄÎπÑ</th>
                                </tr>
                            </thead>
                            <tbody id="detailStatsBody">
                                <!-- ÏÉÅÏÑ∏ ÌÜµÍ≥ÑÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <style>
        /* Ï∞®Ìä∏ Í∑∏Î¶¨Îìú */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        /* Ï∞®Ìä∏ Ïª®ÌÖåÏù¥ÎÑà */
        .chart-container {
            padding: 24px;
            position: relative;
            height: 300px;
        }
        
        /* Ï∞®Ìä∏ Í∏∞Í∞Ñ ÏÑ†ÌÉù */
        .chart-period {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }
        
        /* ÏÉÅÏÑ∏ ÌÜµÍ≥Ñ ÌÖåÏù¥Î∏î */
        .table td:nth-child(3),
        .table td:nth-child(4) {
            font-weight: 500;
        }
        
        .positive-change {
            color: var(--success-color);
        }
        
        .negative-change {
            color: var(--danger-color);
        }
        
        /* Î∞òÏùëÌòï */
        @media (max-width: 1024px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    
    <script src="js/common.js"></script>
    
    <script>
        // Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§
        let charts = {};
        
        // ÌéòÏù¥ÏßÄ Ï¥àÍ∏∞Ìôî
        window.addEventListener('DOMContentLoaded', async () => {
            // Î∞±ÏóîÎìú Ï¥àÍ∏∞Ìôî
            const backendReady = await initializeBackends();
            if (!backendReady) {
                showToast('Î∞±ÏóîÎìú Ïó∞Í≤∞ Ïã§Ìå®', 'error');
                return;
            }
            
            // Ïù¥Î≤§Ìä∏ Î™©Î°ù Î°úÎìú
            loadEventOptions();
            
            // ÌÜµÍ≥Ñ Î°úÎìú
            loadAnalytics();
            
            // Ï∞®Ìä∏ Ï¥àÍ∏∞Ìôî
            initializeCharts();
        });
        
        // ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        async function loadAnalytics() {
            try {
                const stats = await api.getStats();
                
                // ÌÜµÍ≥Ñ Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById('totalParticipants').textContent = stats.total || 0;
                const avgRate = stats.total > 0 ? Math.round((stats.checkedIn / stats.total) * 100) : 0;
                document.getElementById('avgAttendanceRate').textContent = avgRate + '%';
                
                // Ïò§Îäò/Ï£ºÍ∞Ñ Ï≤¥ÌÅ¨Ïù∏ (ÏûÑÏãú Îç∞Ïù¥ÌÑ∞)
                document.getElementById('todayCheckins').textContent = Math.floor(stats.checkedIn * 0.3) || 0;
                document.getElementById('weekCheckins').textContent = stats.checkedIn || 0;
                
                // ÏÉÅÏÑ∏ ÌÜµÍ≥Ñ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
                updateDetailStats(stats);
                
                // Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                updateChartData();
                
            } catch (error) {
                console.error('ÌÜµÍ≥Ñ Î°úÎìú Ïã§Ìå®:', error);
                showToast('ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§', 'error');
            }
        }
        
        // Ï∞®Ìä∏ Ï¥àÍ∏∞Ìôî
        function initializeCharts() {
            // Ï≤¥ÌÅ¨Ïù∏ Ï∂îÏù¥ Ï∞®Ìä∏
            const checkinCtx = document.getElementById('checkinTrendChart').getContext('2d');
            charts.checkinTrend = new Chart(checkinCtx, {
                type: 'line',
                data: {
                    labels: ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'],
                    datasets: [{
                        label: 'Ï≤¥ÌÅ¨Ïù∏ Ïàò',
                        data: [12, 19, 15, 25, 22, 30, 28],
                        borderColor: 'rgb(99, 102, 241)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // Ï∞∏Í∞ÄÏûê Ïú†Ìòï Î∂ÑÌè¨ Ï∞®Ìä∏
            const typeCtx = document.getElementById('participantTypeChart').getContext('2d');
            charts.participantType = new Chart(typeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Ï¥àÎåÄ', 'ÌòÑÏû•Î∞©Î¨∏', 'ÎØ∏Ï†ï'],
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: [
                            'rgb(99, 102, 241)',
                            'rgb(34, 197, 94)',
                            'rgb(249, 115, 22)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // ÏãúÍ∞ÑÎåÄÎ≥Ñ Ï≤¥ÌÅ¨Ïù∏ Ï∞®Ìä∏
            const hourlyCtx = document.getElementById('hourlyCheckinChart').getContext('2d');
            charts.hourlyCheckin = new Chart(hourlyCtx, {
                type: 'bar',
                data: {
                    labels: ['9Ïãú', '10Ïãú', '11Ïãú', '12Ïãú', '13Ïãú', '14Ïãú', '15Ïãú', '16Ïãú', '17Ïãú'],
                    datasets: [{
                        label: 'Ï≤¥ÌÅ¨Ïù∏ Ïàò',
                        data: [5, 12, 18, 10, 8, 15, 20, 18, 12],
                        backgroundColor: 'rgba(99, 102, 241, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // ÌöåÏÇ¨Î≥Ñ Ï∞∏Í∞ÄÏûê Ï∞®Ìä∏
            const companyCtx = document.getElementById('companyChart').getContext('2d');
            charts.company = new Chart(companyCtx, {
                type: 'horizontalBar',
                data: {
                    labels: ['AÏÇ¨', 'BÏÇ¨', 'CÏÇ¨', 'DÏÇ¨', 'Í∏∞ÌÉÄ'],
                    datasets: [{
                        label: 'Ï∞∏Í∞ÄÏûê Ïàò',
                        data: [15, 12, 8, 6, 20],
                        backgroundColor: [
                            'rgba(99, 102, 241, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(249, 115, 22, 0.8)',
                            'rgba(236, 72, 153, 0.8)',
                            'rgba(107, 114, 128, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // ÏÉÅÏÑ∏ ÌÜµÍ≥Ñ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateDetailStats(stats) {
            const tbody = document.getElementById('detailStatsBody');
            const detailData = [
                {
                    name: 'Ï†ÑÏ≤¥ Îì±Î°ùÏûê',
                    value: stats.total || 0,
                    weekChange: '+12%',
                    monthChange: '+25%'
                },
                {
                    name: 'Ï≤¥ÌÅ¨Ïù∏ ÏôÑÎ£å',
                    value: stats.checkedIn || 0,
                    weekChange: '+8%',
                    monthChange: '+18%'
                },
                {
                    name: 'ÎØ∏Ï≤¥ÌÅ¨Ïù∏',
                    value: (stats.total - stats.checkedIn) || 0,
                    weekChange: '-5%',
                    monthChange: '-12%'
                },
                {
                    name: 'ÌèâÍ∑† Ï≤¥ÌÅ¨Ïù∏ ÏãúÍ∞Ñ',
                    value: '10:30 AM',
                    weekChange: 'Î≥ÄÎèôÏóÜÏùå',
                    monthChange: '15Î∂Ñ Îã®Ï∂ï'
                }
            ];
            
            tbody.innerHTML = detailData.map(item => {
                const weekClass = item.weekChange.includes('+') ? 'positive-change' : 
                                 item.weekChange.includes('-') ? 'negative-change' : '';
                const monthClass = item.monthChange.includes('+') ? 'positive-change' : 
                                  item.monthChange.includes('-') ? 'negative-change' : '';
                
                return `
                    <tr>
                        <td>${item.name}</td>
                        <td><strong>${item.value}</strong></td>
                        <td class="${weekClass}">${item.weekChange}</td>
                        <td class="${monthClass}">${item.monthChange}</td>
                    </tr>
                `;
            }).join('');
        }
        
        // Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateChartData() {
            // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞Î°ú Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Î°úÏßÅ
            // APIÏóêÏÑú Î∞õÏùÄ Îç∞Ïù¥ÌÑ∞Î•º Ï∞®Ìä∏Ïóê Î∞òÏòÅ
        }
        
        // ÌÜµÍ≥Ñ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
        function exportAnalytics() {
            showToast('ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞Î•º Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§...', 'info');
            // CSV ÎòêÎäî PDFÎ°ú ÌÜµÍ≥Ñ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Íµ¨ÌòÑ
        }
        
        // Í∏∞Í∞Ñ Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏
        document.getElementById('checkinPeriod')?.addEventListener('change', (e) => {
            const period = e.target.value;
            updateCheckinTrendChart(period);
        });
        
        // Ï≤¥ÌÅ¨Ïù∏ Ï∂îÏù¥ Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
        function updateCheckinTrendChart(period) {
            let labels, data;
            
            switch(period) {
                case 'week':
                    labels = ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'];
                    data = [12, 19, 15, 25, 22, 30, 28];
                    break;
                case 'month':
                    labels = ['1Ï£º', '2Ï£º', '3Ï£º', '4Ï£º'];
                    data = [85, 92, 78, 95];
                    break;
                case 'year':
                    labels = ['1Ïõî', '2Ïõî', '3Ïõî', '4Ïõî', '5Ïõî', '6Ïõî'];
                    data = [320, 380, 350, 400, 420, 450];
                    break;
            }
            
            charts.checkinTrend.data.labels = labels;
            charts.checkinTrend.data.datasets[0].data = data;
            charts.checkinTrend.update();
        }
    </script>
</body>
</html>